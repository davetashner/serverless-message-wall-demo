# DynamoDB table for message wall data
# See ADR-004 (DynamoDB Schema) for single-table design details
#
# Schema:
#   PK (String) - Partition key: "METADATA" or "MESSAGE"
#   SK (String) - Sort key: "METADATA" or "<timestamp>#<uuid>"
#
# Record types:
#   METADATA record: PK=METADATA, SK=METADATA, messageCount=N
#   MESSAGE record: PK=MESSAGE, SK=<timestamp>#<uuid>, text=S, createdAt=S
---
apiVersion: dynamodb.aws.upbound.io/v1beta2
kind: Table
metadata:
  name: ${RESOURCE_PREFIX}-${ENVIRONMENT}-table
  annotations:
    crossplane.io/external-name: ${BUCKET_NAME}
spec:
  forProvider:
    region: ${AWS_REGION}
    billingMode: PAY_PER_REQUEST
    hashKey: PK
    rangeKey: SK
    attribute:
      - name: PK
        type: S
      - name: SK
        type: S
  providerConfigRef:
    name: default
